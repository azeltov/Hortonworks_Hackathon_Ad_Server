{"topologyName":"AdServerDemo","config":"{\"topology.workers\":1,\"topology.acker.executors\":1,\"topology.message.timeout.secs\":30,\"hbaseConf\":{\"hbase.rootdir\":\"hdfs://localhost:9000/tmp/hbase\"}}","sources":[{"id":116,"topologyId":15,"topologyComponentBundleId":1,"versionId":95,"name":"KAFKA","description":"","config":{"properties":{"cluster":"1","consumerGroupId":"adserver_group","useStartOffsetTimeIfOffsetOutOfRange":true,"ignoreZkOffsets":false,"retryDelayMaxMs":60000,"parallelism":1,"refreshFreqSecs":60,"metricsTimeBucketSizeInSecs":60,"zkPort":2181,"retryInitialDelayMs":0,"maxOffsetBehind":9007199254740991,"zkPath":"/brokers","retryDelayMultiplier":1,"stateUpdateIntervalMs":2000,"bufferSizeBytes":1048576,"zkUrl":"dzaratsian-10.field.hortonworks.com:2181","socketTimeoutMs":10000,"topic":"adserver","fetchMaxWait":10000,"fetchSizeBytes":1048576,"clusters":"sam_hdf"}},"outputStreams":[{"id":98,"versionId":95,"streamId":"kafka_stream_116","description":null,"topologyId":15,"fields":[{"name":"userid","type":"STRING","optional":false},{"name":"campaignid","type":"STRING","optional":false},{"name":"timestamp","type":"STRING","optional":false},{"name":"mediatype","type":"STRING","optional":false},{"name":"adtype","type":"STRING","optional":false},{"name":"activity","type":"STRING","optional":false},{"name":"city","type":"STRING","optional":false},{"name":"state","type":"STRING","optional":false},{"name":"age","type":"INTEGER","optional":false},{"name":"campaign_area","type":"STRING","optional":false},{"name":"campaign_category","type":"STRING","optional":false}],"timestamp":1495590496725}],"timestamp":1495589717476}],"sinks":[{"id":117,"topologyId":15,"topologyComponentBundleId":16,"versionId":95,"name":"ClickStream","description":"","config":{"properties":{"cluster":"2","clusterReplication":1,"segmentGranularity":"FIVE_MINUTE","indexRetryPeriod":"PT10M","maxBatchSize":20,"maxPendingBatches":5,"discoveryPath":"/druid/discovery","clusterPartitions":1,"windowPeriod":"PT10M","aggregatorList":[],"tranquilityZKconnect":"dzaratsian-11.field.hortonworks.com:2181","discardStreamId":"DRUID-DISCARD-STREAM-ID","indexService":"druid/overlord","blockOnFull":true,"timestampField":"processingTime","lingerMillis":5000,"queryGranularity":"MINUTE","dataSource":"d_clickstream","clusters":"sam_hdp","dimensions":["userid","campaignid","timestamp","mediatype","adtype","activity","city","state","age","campaign_area","campaign_category"]}},"timestamp":1495590496725},{"id":124,"topologyId":15,"topologyComponentBundleId":10,"versionId":95,"name":"LowClickRates","description":"","config":{"properties":{"fsUrl":"hdfs://dzaratsian-11.field.hortonworks.com:8020","outputFields":["campaignid","activity","activity_COUNT"],"cluster":"2","path":"/tmp/samtest","extension":".txt","rotationPolicy":{"timeBasedRotation":{"rotationInterval":1,"rotationIntervalUnit":"MINUTES"}},"prefix":"lowclickrates","parallelism":1,"countPolicyValue":10,"clusters":"sam_hdp"}},"timestamp":1495590496725},{"id":120,"topologyId":15,"topologyComponentBundleId":10,"versionId":95,"name":"EngagedUsers","description":"","config":{"properties":{"fsUrl":"hdfs://dzaratsian-11.field.hortonworks.com:8020","outputFields":["userid","userid_COUNT"],"cluster":"2","path":"/tmp/samtest","extension":".txt","rotationPolicy":{"timeBasedRotation":{"rotationInterval":1,"rotationIntervalUnit":"MINUTES"}},"prefix":"engaged_users","parallelism":1,"countPolicyValue":10,"clusters":"sam_hdp"}},"timestamp":1495590496725}],"processors":[{"id":121,"topologyId":15,"topologyComponentBundleId":5,"versionId":95,"name":"Campaigns","description":"","config":{"properties":{"rules":[22],"parallelism":1}},"outputStreams":[{"id":103,"versionId":95,"streamId":"window_transform_stream_121","description":null,"topologyId":15,"fields":[{"name":"campaignid","type":"STRING","optional":false},{"name":"activity","type":"STRING","optional":false},{"name":"activity_COUNT","type":"LONG","optional":false}],"timestamp":1495590496725},{"id":104,"versionId":95,"streamId":"window_notifier_stream_121","description":null,"topologyId":15,"fields":[{"name":"campaignid","type":"STRING","optional":false},{"name":"activity","type":"STRING","optional":false},{"name":"activity_COUNT","type":"LONG","optional":false}],"timestamp":1495590496725}],"timestamp":1495590496725},{"id":123,"topologyId":15,"topologyComponentBundleId":4,"versionId":95,"name":"LowClickRate","description":"","config":{"properties":{"rules":[21]}},"outputStreams":[{"id":105,"versionId":95,"streamId":"rule_transform_stream_21","description":null,"topologyId":15,"fields":[{"name":"campaignid","type":"STRING","optional":false},{"name":"activity","type":"STRING","optional":false},{"name":"activity_COUNT","type":"LONG","optional":false}],"timestamp":1495590496725},{"id":106,"versionId":95,"streamId":"rule_notifier_stream_21","description":null,"topologyId":15,"fields":[{"name":"campaignid","type":"STRING","optional":false},{"name":"activity","type":"STRING","optional":false},{"name":"activity_COUNT","type":"LONG","optional":false}],"timestamp":1495590496725}],"timestamp":1495590496725},{"id":118,"topologyId":15,"topologyComponentBundleId":5,"versionId":95,"name":"Engaged","description":"","config":{"properties":{"rules":[21],"parallelism":1}},"outputStreams":[{"id":99,"versionId":95,"streamId":"window_transform_stream_118","description":null,"topologyId":15,"fields":[{"name":"userid","type":"STRING","optional":false},{"name":"userid_COUNT","type":"LONG","optional":false}],"timestamp":1495590496725},{"id":100,"versionId":95,"streamId":"window_notifier_stream_118","description":null,"topologyId":15,"fields":[{"name":"userid","type":"STRING","optional":false},{"name":"userid_COUNT","type":"LONG","optional":false}],"timestamp":1495590496725}],"timestamp":1495590496725},{"id":119,"topologyId":15,"topologyComponentBundleId":4,"versionId":95,"name":"UserEngagement","description":"","config":{"properties":{"rules":[20]}},"outputStreams":[{"id":101,"versionId":95,"streamId":"rule_transform_stream_20","description":null,"topologyId":15,"fields":[{"name":"userid","type":"STRING","optional":false},{"name":"userid_COUNT","type":"LONG","optional":false}],"timestamp":1495590496725},{"id":102,"versionId":95,"streamId":"rule_notifier_stream_20","description":null,"topologyId":15,"fields":[{"name":"userid","type":"STRING","optional":false},{"name":"userid_COUNT","type":"LONG","optional":false}],"timestamp":1495590496725}],"timestamp":1495590496725}],"edges":[{"id":137,"versionId":95,"topologyId":15,"fromId":116,"toId":117,"streamGroupings":[{"streamId":98,"grouping":"SHUFFLE","fields":null}],"timestamp":1495590496725},{"id":138,"versionId":95,"topologyId":15,"fromId":116,"toId":118,"streamGroupings":[{"streamId":98,"grouping":"FIELDS","fields":["userid"]}],"timestamp":1495590496725},{"id":141,"versionId":95,"topologyId":15,"fromId":116,"toId":121,"streamGroupings":[{"streamId":98,"grouping":"FIELDS","fields":["campaignid","activity"]}],"timestamp":1495590496725},{"id":142,"versionId":95,"topologyId":15,"fromId":121,"toId":123,"streamGroupings":[{"streamId":103,"grouping":"SHUFFLE","fields":null}],"timestamp":1495590496725},{"id":143,"versionId":95,"topologyId":15,"fromId":123,"toId":124,"streamGroupings":[{"streamId":105,"grouping":"SHUFFLE","fields":null}],"timestamp":1495590496725},{"id":139,"versionId":95,"topologyId":15,"fromId":118,"toId":119,"streamGroupings":[{"streamId":99,"grouping":"SHUFFLE","fields":null}],"timestamp":1495590496725},{"id":140,"versionId":95,"topologyId":15,"fromId":119,"toId":120,"streamGroupings":[{"streamId":101,"grouping":"SHUFFLE","fields":null}],"timestamp":1495590496725}],"rules":[{"id":21,"versionId":95,"topologyId":15,"name":"Low Click Rate","description":"Low Click Rate","streams":["window_transform_stream_121"],"condition":"activity_COUNT = 0","sql":"SELECT *  FROM window_transform_stream_121 WHERE activity_COUNT = 0","actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["rule_transform_stream_21"],"transforms":[]}],"outputStreams":["rule_transform_stream_21","rule_notifier_stream_21"],"timestamp":1495590496725},{"id":20,"versionId":95,"topologyId":15,"name":"Engaged User","description":"Engaged User (3 or more clicks within time window)","streams":["window_transform_stream_118"],"condition":"userid_COUNT >= 3","sql":"SELECT *  FROM window_transform_stream_118 WHERE userid_COUNT >= 3","actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["rule_transform_stream_20"],"transforms":[]}],"outputStreams":["rule_transform_stream_20","rule_notifier_stream_20"],"timestamp":1495590496725}],"windows":[{"id":22,"versionId":95,"topologyId":15,"name":"window_auto_generated","description":"window description auto generated","streams":["kafka_stream_116"],"window":{"windowLength":{"class":".Window$Duration","durationMs":60000},"slidingInterval":{"class":".Window$Duration","durationMs":60000},"tsField":null,"lagMs":0},"actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["window_transform_stream_121"],"transforms":[]}],"projections":[{"functionName":"COUNT","args":["activity"],"outputFieldName":"activity_COUNT"},{"expr":"campaignid"},{"expr":"activity"}],"groupbykeys":["campaignid","activity"],"outputStreams":["window_transform_stream_121","window_notifier_stream_121"],"timestamp":1495590496725},{"id":21,"versionId":95,"topologyId":15,"name":"window_auto_generated","description":"window description auto generated","streams":["kafka_stream_116"],"window":{"windowLength":{"class":".Window$Duration","durationMs":60000},"slidingInterval":{"class":".Window$Duration","durationMs":60000},"tsField":null,"lagMs":0},"actions":[{"__type":"com.hortonworks.streamline.streams.layout.component.rule.action.TransformAction","name":"transformAction","outputStreams":["window_transform_stream_118"],"transforms":[]}],"projections":[{"functionName":"COUNT","args":["userid"],"outputFieldName":"userid_COUNT"},{"expr":"userid"}],"groupbykeys":["userid"],"outputStreams":["window_transform_stream_118","window_notifier_stream_118"],"timestamp":1495590496725}],"branchRules":[],"bundleIdToType":{"1":"KAFKA","4":"RULE","16":"DRUID","5":"WINDOW","10":"HDFS"},"topologyEditorMetadata":{"topologyId":15,"versionId":95,"data":"{\"sources\":[{\"x\":146.25,\"y\":249.5,\"id\":116}],\"processors\":[{\"x\":450.575439453125,\"y\":347.12158203125,\"id\":118},{\"x\":698.5865478515625,\"y\":346.7505798339844,\"id\":119},{\"x\":449.87371826171875,\"y\":446.2322692871094,\"id\":121},{\"x\":701.004638671875,\"y\":446.2322692871094,\"id\":123}],\"sinks\":[{\"x\":451.23272705078125,\"y\":249.3258056640625,\"id\":117},{\"x\":960.8330078125,\"y\":346.9236755371094,\"id\":120},{\"x\":961.79443359375,\"y\":446.2322692871094,\"id\":124}],\"graphTransforms\":{\"dragCoords\":[-117.77410572894405,-164.36554861496148],\"zoomScale\":1.1519450548117558}}","timestamp":1495590496725}}